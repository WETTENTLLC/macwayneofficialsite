<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Preview Test - Mac Wayne</title>
    <link rel="stylesheet" href="styles/main.css">
    <style>
        body {
            padding: 2rem;
            background: #121212;
            color: white;
            font-family: Arial, sans-serif;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-controls {
            margin: 2rem 0;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }
        .test-controls button {
            margin: 0.5rem;
            padding: 0.5rem 1rem;
            background: #ff6600;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .test-controls button:hover {
            background: #ff8833;
        }
        .log-output {
            background: #000;
            padding: 1rem;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.875rem;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Mac Wayne Audio Preview Test</h1>
        
        <div class="test-controls">
            <h3>Test Controls</h3>
            <button onclick="testPreviewStatus()">Check Preview Status</button>
            <button onclick="unlockTracks()">Unlock Full Tracks</button>
            <button onclick="clearLog()">Clear Log</button>
            <button onclick="playFirstTrack()">Play First Track</button>
        </div>
        
        <div class="audio-player preview-mode" data-src="/audio/test-track.mp3" data-title="Test Track" data-duration="2:00" data-preview="true">
            <div class="track-info">
                <div class="track-title">Test Track</div>
                <div class="track-artist">Mac Wayne</div>
                <span class="preview-indicator">30-Sec Preview</span>
            </div>
            
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
                <div class="time-display">
                    <span class="current-time">0:00</span>
                    <span class="duration">0:30</span>
                </div>
            </div>
            
            <button class="play-btn">
                <svg class="play-icon" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                    <path d="M8 5v14l11-7z"/>
                </svg>
                <svg class="pause-icon hidden" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                    <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                </svg>
            </button>
            
            <audio preload="metadata"></audio>
        </div>
        
        <div id="log-output" class="log-output"></div>
    </div>
    
    <script src="js/audio-player.js"></script>
    <script>
        // Override console.log to capture output
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            const logOutput = document.getElementById('log-output');
            const logEntry = document.createElement('div');
            logEntry.textContent = args.join(' ');
            logEntry.style.marginBottom = '4px';
            logOutput.appendChild(logEntry);
            logOutput.scrollTop = logOutput.scrollHeight;
        };
        
        function testPreviewStatus() {
            if (window.testPreviewMode) {
                const status = window.testPreviewMode();
                console.log('Preview Status:', JSON.stringify(status, null, 2));
            } else {
                console.log('testPreviewMode function not available');
            }
        }
        
        function clearLog() {
            document.getElementById('log-output').innerHTML = '';
        }
        
        function playFirstTrack() {
            if (window.audioPlayers && window.audioPlayers.length > 0) {
                console.log('Attempting to play first track...');
                window.audioPlayers[0].togglePlayPause();
            } else {
                console.log('No audio players available');
            }
        }
        
        // Test on page load
        window.addEventListener('load', function() {
            setTimeout(() => {
                console.log('=== AUDIO PREVIEW TEST INITIALIZED ===');
                testPreviewStatus();
            }, 1000);
        });
    </script>
</body>
</html>
