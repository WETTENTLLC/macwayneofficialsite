<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mac Wayne Crypto System Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a1a1a;
            color: #ffffff;
        }
        .test-container {
            background: #2d2d2d;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .test-result {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
        }
        .test-pass {
            background-color: #2d5a2d;
            border-left: 4px solid #4caf50;
        }
        .test-fail {
            background-color: #5a2d2d;
            border-left: 4px solid #f44336;
        }
        .test-warning {
            background-color: #5a4d2d;
            border-left: 4px solid #ff9800;
        }
        button {
            background: linear-gradient(45deg, #6b46c1, #9333ea);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px 5px;
            font-weight: bold;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        .system-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .status-card {
            background: #3d3d3d;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .status-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 10px;
        }
        .status-online { background-color: #4caf50; }
        .status-offline { background-color: #f44336; }
        .status-loading { background-color: #ff9800; }
        #test-log {
            background: #1e1e1e;
            padding: 15px;
            border-radius: 5px;
            max-height: 400px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>🚀 Mac Wayne Crypto System Test Suite</h1>
    
    <div class="test-container">
        <h2>System Status</h2>
        <div class="system-status">
            <div class="status-card">
                <span class="status-indicator status-loading" id="master-status"></span>
                <div>Master Controller</div>
            </div>
            <div class="status-card">
                <span class="status-indicator status-loading" id="wallet-status"></span>
                <div>Wallet Integration</div>
            </div>
            <div class="status-card">
                <span class="status-indicator status-loading" id="market-status"></span>
                <div>Market Data</div>
            </div>
            <div class="status-card">
                <span class="status-indicator status-loading" id="contracts-status"></span>
                <div>Smart Contracts</div>
            </div>
            <div class="status-card">
                <span class="status-indicator status-loading" id="staking-status"></span>
                <div>Value Generation</div>
            </div>
            <div class="status-card">
                <span class="status-indicator status-loading" id="marketplace-status"></span>
                <div>Marketplace</div>
            </div>
        </div>
    </div>

    <div class="test-container">
        <h2>Test Controls</h2>
        <button onclick="runAllTests()">🧪 Run All Tests</button>
        <button onclick="testWalletIntegration()">💰 Test Wallet</button>
        <button onclick="testMarketData()">📊 Test Market Data</button>
        <button onclick="testSmartContracts()">📋 Test Contracts</button>
        <button onclick="testValueGeneration()">💎 Test Staking</button>
        <button onclick="testMarketplace()">🏪 Test Marketplace</button>
        <button onclick="testAccessibility()">♿ Test Accessibility</button>
        <button onclick="clearResults()">🗑️ Clear Results</button>
    </div>

    <div class="test-container">
        <h2>Test Results</h2>
        <div id="test-results"></div>
    </div>

    <div class="test-container">
        <h2>Test Log</h2>
        <div id="test-log"></div>
    </div>

    <script>
        // Test logging
        function log(message, type = 'info') {
            const logDiv = document.getElementById('test-log');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${type.toUpperCase()}: ${message}\n`;
            logDiv.textContent += logEntry;
            logDiv.scrollTop = logDiv.scrollHeight;
            
            if (type === 'info') console.log(message);
            else if (type === 'warn') console.warn(message);
            else if (type === 'error') console.error(message);
        }

        // Test result tracking
        let testResults = [];

        function addTestResult(testName, passed, message) {
            const result = { testName, passed, message, timestamp: new Date() };
            testResults.push(result);
            
            const resultsDiv = document.getElementById('test-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = passed ? 'test-result test-pass' : 'test-result test-fail';
            resultDiv.innerHTML = `
                <strong>${testName}</strong>: ${passed ? '✅ PASS' : '❌ FAIL'}
                <br><small>${message}</small>
            `;
            resultsDiv.appendChild(resultDiv);
            
            log(`${testName}: ${passed ? 'PASS' : 'FAIL'} - ${message}`, passed ? 'info' : 'error');
        }

        function addWarning(testName, message) {
            const resultsDiv = document.getElementById('test-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = 'test-result test-warning';
            resultDiv.innerHTML = `
                <strong>${testName}</strong>: ⚠️ WARNING
                <br><small>${message}</small>
            `;
            resultsDiv.appendChild(resultDiv);
            
            log(`${testName}: WARNING - ${message}`, 'warn');
        }

        // Status indicators
        function updateStatus(component, status) {
            const statusElement = document.getElementById(`${component}-status`);
            if (statusElement) {
                statusElement.className = `status-indicator status-${status}`;
            }
        }

        // Initialize system testing
        document.addEventListener('DOMContentLoaded', async function() {
            log('🚀 Starting Mac Wayne Crypto System Tests...');
            
            // Wait for system initialization
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // Check system components
            checkSystemComponents();
            
            log('✅ Test suite initialized');
        });

        function checkSystemComponents() {
            log('🔍 Checking system components...');
            
            // Check Master Controller
            if (window.cryptoSystem) {
                updateStatus('master', 'online');
                log('✅ Master Controller loaded');
            } else {
                updateStatus('master', 'offline');
                log('❌ Master Controller not found', 'error');
            }
            
            // Check individual modules
            const modules = [
                { name: 'walletManager', status: 'wallet' },
                { name: 'marketDataManager', status: 'market' },
                { name: 'smartContractManager', status: 'contracts' },
                { name: 'valueGenerationManager', status: 'staking' },
                { name: 'marketplaceManager', status: 'marketplace' }
            ];
            
            modules.forEach(module => {
                if (window[module.name]) {
                    updateStatus(module.status, 'online');
                    log(`✅ ${module.name} loaded`);
                } else {
                    updateStatus(module.status, 'offline');
                    log(`❌ ${module.name} not found`, 'warn');
                }
            });
        }

        async function runAllTests() {
            log('🧪 Running comprehensive test suite...');
            clearResults();
            
            const tests = [
                testMasterController,
                testWalletIntegration,
                testMarketData,
                testSmartContracts,
                testValueGeneration,
                testMarketplace,
                testAccessibility,
                testPerformance
            ];
            
            for (const test of tests) {
                try {
                    await test();
                    await new Promise(resolve => setTimeout(resolve, 500)); // Delay between tests
                } catch (error) {
                    log(`Test failed: ${error.message}`, 'error');
                }
            }
            
            // Generate summary
            const passed = testResults.filter(r => r.passed).length;
            const total = testResults.length;
            
            log(`\n📊 Test Summary: ${passed}/${total} tests passed`);
            
            if (passed === total) {
                log('🎉 All tests passed! System is ready for production.', 'info');
            } else {
                log(`⚠️ ${total - passed} tests failed. Review issues before deployment.`, 'warn');
            }
        }

        async function testMasterController() {
            log('Testing Master Controller...');
            
            try {
                if (!window.cryptoSystem) {
                    addTestResult('Master Controller Availability', false, 'cryptoSystem not found in window object');
                    return;
                }
                
                addTestResult('Master Controller Availability', true, 'Master controller loaded successfully');
                
                // Test initialization status
                const status = window.cryptoSystem.getSystemStatus();
                addTestResult('System Initialization', status.initialized, 
                    status.initialized ? 'System fully initialized' : 'System not initialized');
                
                // Test module loading
                const expectedModules = ['walletIntegration', 'marketData', 'smartContracts', 'valueGeneration', 'marketplaceIntegration', 'userExperience'];
                const loadedModules = status.modules || [];
                const missingModules = expectedModules.filter(mod => !loadedModules.includes(mod));
                
                if (missingModules.length === 0) {
                    addTestResult('Module Loading', true, 'All expected modules loaded');
                } else {
                    addTestResult('Module Loading', false, `Missing modules: ${missingModules.join(', ')}`);
                }
                
                // Test event system
                let eventReceived = false;
                window.cryptoSystem.on('test:event', () => { eventReceived = true; });
                window.cryptoSystem.emit('test:event');
                
                addTestResult('Event System', eventReceived, 
                    eventReceived ? 'Event system working' : 'Event system failed');
                
            } catch (error) {
                addTestResult('Master Controller Test', false, `Error: ${error.message}`);
            }
        }

        async function testWalletIntegration() {
            log('Testing Wallet Integration...');
            
            try {
                if (!window.walletManager) {
                    addTestResult('Wallet Manager Availability', false, 'walletManager not found');
                    return;
                }
                
                addTestResult('Wallet Manager Availability', true, 'Wallet manager loaded');
                
                // Test wallet provider detection
                const providers = await window.walletManager.getAvailableWallets();
                addTestResult('Wallet Provider Detection', providers.length > 0, 
                    `Found ${providers.length} wallet providers`);
                
                // Test wallet connection UI
                const walletButtons = document.querySelectorAll('.wallet-connect-btn');
                addTestResult('Wallet UI Elements', walletButtons.length > 0, 
                    `Found ${walletButtons.length} wallet connection buttons`);
                
                // Test wallet status display
                const walletStatus = document.getElementById('wallet-status');
                addTestResult('Wallet Status Display', !!walletStatus, 
                    walletStatus ? 'Wallet status element present' : 'Wallet status element missing');
                
            } catch (error) {
                addTestResult('Wallet Integration Test', false, `Error: ${error.message}`);
            }
        }

        async function testMarketData() {
            log('Testing Market Data System...');
            
            try {
                if (!window.marketDataManager) {
                    addTestResult('Market Data Manager', false, 'marketDataManager not found');
                    return;
                }
                
                addTestResult('Market Data Manager', true, 'Market data manager loaded');
                
                // Test price display elements
                const priceElement = document.getElementById('mwb-price');
                const changeElement = document.getElementById('mwb-change');
                
                addTestResult('Price Display Elements', !!(priceElement && changeElement), 
                    'Price and change display elements found');
                
                // Test market data fetching (mock)
                try {
                    // This would normally fetch real data, but we'll simulate
                    const mockData = { price: '0.001', change: '+2.5%', volume: '10000' };
                    addTestResult('Market Data Fetching', true, 'Market data simulation successful');
                } catch (error) {
                    addTestResult('Market Data Fetching', false, `Failed to fetch market data: ${error.message}`);
                }
                
                // Test chart container
                const chartContainer = document.getElementById('price-chart');
                addTestResult('Price Chart Container', !!chartContainer, 
                    chartContainer ? 'Price chart container found' : 'Price chart container missing');
                
            } catch (error) {
                addTestResult('Market Data Test', false, `Error: ${error.message}`);
            }
        }

        async function testSmartContracts() {
            log('Testing Smart Contracts System...');
            
            try {
                if (!window.smartContractManager) {
                    addTestResult('Smart Contract Manager', false, 'smartContractManager not found');
                    return;
                }
                
                addTestResult('Smart Contract Manager', true, 'Smart contract manager loaded');
                
                // Test contract configuration
                const contractConfig = window.smartContractManager.getContractConfig?.();
                addTestResult('Contract Configuration', !!contractConfig, 
                    contractConfig ? 'Contract configuration available' : 'Contract configuration missing');
                
                // Test transaction handling UI
                const buyButtons = document.querySelectorAll('.purchase-button, .buy-mwb-btn');
                addTestResult('Transaction UI Elements', buyButtons.length > 0, 
                    `Found ${buyButtons.length} transaction buttons`);
                
            } catch (error) {
                addTestResult('Smart Contracts Test', false, `Error: ${error.message}`);
            }
        }

        async function testValueGeneration() {
            log('Testing Value Generation System...');
            
            try {
                if (!window.valueGenerationManager) {
                    addTestResult('Value Generation Manager', false, 'valueGenerationManager not found');
                    return;
                }
                
                addTestResult('Value Generation Manager', true, 'Value generation manager loaded');
                
                // Test staking UI elements
                const stakingSection = document.getElementById('staking-section');
                const stakingPools = document.getElementById('staking-pools');
                
                addTestResult('Staking UI Elements', !!(stakingSection && stakingPools), 
                    'Staking interface elements found');
                
                // Test tab functionality
                const tabButtons = document.querySelectorAll('.tab-btn');
                addTestResult('Value Generation Tabs', tabButtons.length >= 4, 
                    `Found ${tabButtons.length} value generation tabs`);
                
                // Test stats display
                const statsElements = document.querySelectorAll('.stat-value');
                addTestResult('Statistics Display', statsElements.length > 0, 
                    `Found ${statsElements.length} statistics display elements`);
                
            } catch (error) {
                addTestResult('Value Generation Test', false, `Error: ${error.message}`);
            }
        }

        async function testMarketplace() {
            log('Testing Marketplace Integration...');
            
            try {
                if (!window.marketplaceManager) {
                    addTestResult('Marketplace Manager', false, 'marketplaceManager not found');
                    return;
                }
                
                addTestResult('Marketplace Manager', true, 'Marketplace manager loaded');
                
                // Test NFT marketplace elements
                const marketplaceSection = document.getElementById('marketplace-section');
                const nftGrid = document.querySelector('.nft-grid');
                
                addTestResult('Marketplace UI Elements', !!(marketplaceSection && nftGrid), 
                    'Marketplace interface elements found');
                
                // Test category navigation
                const categoryButtons = document.querySelectorAll('.category-btn');
                addTestResult('NFT Categories', categoryButtons.length > 0, 
                    `Found ${categoryButtons.length} NFT category buttons`);
                
            } catch (error) {
                addTestResult('Marketplace Test', false, `Error: ${error.message}`);
            }
        }

        async function testAccessibility() {
            log('Testing Accessibility Features...');
            
            try {
                // Test ARIA labels
                const ariaElements = document.querySelectorAll('[aria-label], [aria-labelledby], [role]');
                addTestResult('ARIA Labels', ariaElements.length > 20, 
                    `Found ${ariaElements.length} elements with accessibility attributes`);
                
                // Test keyboard navigation
                const focusableElements = document.querySelectorAll('button, input, select, textarea, a[href]');
                addTestResult('Keyboard Navigation', focusableElements.length > 0, 
                    `Found ${focusableElements.length} focusable elements`);
                
                // Test screen reader announcements
                const announcements = document.querySelectorAll('[aria-live]');
                addTestResult('Screen Reader Support', announcements.length > 0, 
                    `Found ${announcements.length} live regions for screen readers`);
                
                // Test skip links and headings structure
                const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
                addTestResult('Heading Structure', headings.length > 5, 
                    `Found ${headings.length} headings for proper document structure`);
                
                // Test color contrast (basic check)
                const highContrastElements = document.querySelectorAll('.high-contrast, [class*="contrast"]');
                addTestResult('High Contrast Support', true, 
                    'High contrast features available');
                
            } catch (error) {
                addTestResult('Accessibility Test', false, `Error: ${error.message}`);
            }
        }

        async function testPerformance() {
            log('Testing Performance Metrics...');
            
            try {
                // Test page load time
                const navigationTiming = performance.getEntriesByType('navigation')[0];
                const loadTime = navigationTiming.loadEventEnd - navigationTiming.loadEventStart;
                
                addTestResult('Page Load Performance', loadTime < 3000, 
                    `Page loaded in ${loadTime}ms ${loadTime < 3000 ? '(Good)' : '(Needs optimization)'}`);
                
                // Test script loading
                const scripts = document.querySelectorAll('script[src]');
                addTestResult('Script Loading', scripts.length > 5, 
                    `Found ${scripts.length} external scripts`);
                
                // Test memory usage (if available)
                if (performance.memory) {
                    const memoryUsage = performance.memory.usedJSHeapSize / 1024 / 1024;
                    addTestResult('Memory Usage', memoryUsage < 50, 
                        `Using ${memoryUsage.toFixed(2)}MB JavaScript heap ${memoryUsage < 50 ? '(Good)' : '(High)'}`);
                }
                
                // Test responsive design
                const viewportMeta = document.querySelector('meta[name="viewport"]');
                addTestResult('Responsive Design', !!viewportMeta, 
                    'Viewport meta tag present for mobile optimization');
                
            } catch (error) {
                addTestResult('Performance Test', false, `Error: ${error.message}`);
            }
        }

        function clearResults() {
            document.getElementById('test-results').innerHTML = '';
            document.getElementById('test-log').textContent = '';
            testResults = [];
            log('🗑️ Test results cleared');
        }

        // Individual test functions for buttons
        async function testWalletIntegration() { await testWalletIntegration(); }
        async function testMarketData() { await testMarketData(); }
        async function testSmartContracts() { await testSmartContracts(); }
        async function testValueGeneration() { await testValueGeneration(); }
        async function testMarketplace() { await testMarketplace(); }
        async function testAccessibility() { await testAccessibility(); }
    </script>

    <!-- Load the crypto system (same as main page) -->
    <script src="/macwayneofficialsite/js/wallet-integration.js"></script>
    <script src="/macwayneofficialsite/js/market-data.js"></script>
    <script src="/macwayneofficialsite/js/smart-contracts.js"></script>
    <script src="/macwayneofficialsite/js/marketplace-integration.js"></script>
    <script src="/macwayneofficialsite/js/value-generation.js"></script>
    <script src="/macwayneofficialsite/js/user-experience.js"></script>
    <script src="/macwayneofficialsite/js/crypto-optimizer.js"></script>
    <script src="/macwayneofficialsite/js/crypto-testing.js"></script>
    <script src="/macwayneofficialsite/js/crypto-master.js"></script>
</body>
</html>

